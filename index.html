<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tanakh Shorashim Quiz</title>
    
    <!-- --- CACHE CONTROL FIX --- -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <!-- ------------------------- -->

    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for translating JSX in browser -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-gray-900">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- ICONS ---
        const BookOpen = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>
        );
        const Play = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polygon points="5 3 19 12 5 21 5 3"/></svg>
        );
        const Check = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polyline points="20 6 9 17 4 12"/></svg>
        );
        const X = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
        );
        const ChevronRight = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="m9 18 6-6-6-6"/></svg>
        );
        const Award = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="8" r="7"/><polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"/></svg>
        );
        const RotateCcw = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/></svg>
        );
        const AlertCircle = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="10"/><line x1="12" x2="12" y1="8" y2="12"/><line x1="12" x2="12.01" y1="16" y2="16"/></svg>
        );

        // --- DATA ---
        const DATA_SOURCE = [
            { list: 1, shoresh: "א.מ.ר", english: "Say" },
            { list: 1, shoresh: "שׁ.ל.ח", english: "Send" },
            { list: 1, shoresh: "ק.ר.א", english: "Call, Greet, Read" },
            { list: 1, shoresh: "ה.י.ה", english: "Be" },
            { list: 1, shoresh: "ה.ל.כ", english: "Go/Walk" },
            { list: 1, shoresh: "ד.ב.ר", english: "Speak" },
            { list: 1, shoresh: "י.ד.ע", english: "Know" },
            { list: 1, shoresh: "י.צ.א", english: "Go out" },
            { list: 1, shoresh: "ע.שׂ.ה", english: "Do, Make" },
            { list: 1, shoresh: "ל.ק.ח", english: "Take" },
            { list: 2, shoresh: "ע.מ.ד", english: "Stand" },
            { list: 2, shoresh: "ע.ב.ר", english: "Pass" },
            { list: 2, shoresh: "שׁ.מ.ע", english: "Hear/Listen" },
            { list: 2, shoresh: "א.כ.ל", english: "Eat" },
            { list: 2, shoresh: "ק.ו.מ", english: "Get up" },
            { list: 2, shoresh: "מ.ו.ת", english: "Die" },
            { list: 2, shoresh: "י.שׁ.ב", english: "Sit, Live, Dwell" },
            { list: 2, shoresh: "ר.א.ה", english: "See" },
            { list: 2, shoresh: "נ.ת.נ", english: "Give" },
            { list: 2, shoresh: "ב.ו.א", english: "Come" },
            { list: 3, shoresh: "ע.ל.ה", english: "Go up" },
            { list: 3, shoresh: "א.ה.ב", english: "Love" },
            { list: 3, shoresh: "ב.ר.כ", english: "Bless" },
            { list: 3, shoresh: "שׁ.ו.ב", english: "Return" },
            { list: 3, shoresh: "מ.צ.א", english: "Find" },
            { list: 3, shoresh: "י.ר.ד", english: "Go down" },
            { list: 3, shoresh: "ע.ב.ד", english: "Work, Serve" },
            { list: 3, shoresh: "שׂ.י.מ", english: "Put" },
            { list: 3, shoresh: "י.ל.ד", english: "Give Birth/Bring forth" },
            { list: 3, shoresh: "צ.ו.ה", english: "Command" },
            { list: 4, shoresh: "ה.ר.ג", english: "Kill" },
            { list: 4, shoresh: "ז.כ.ר", english: "Remember" },
            { list: 4, shoresh: "א.ס.פ", english: "Gather" },
            { list: 4, shoresh: "ע.נ.ה", english: "Answer, Make suffer" },
            { list: 4, shoresh: "נ.שׂ.א", english: "Lift/Carry" },
            { list: 4, shoresh: "ב.נ.ה", english: "Build" },
            { list: 4, shoresh: "ג.ד.ל", english: "Grow, Be great" },
            { list: 4, shoresh: "ב.ר.א", english: "Create" },
            { list: 4, shoresh: "שׁ.מ.ר", english: "Watch, Guard, Keep" },
            { list: 4, shoresh: "מ.ל.א", english: "Fill" },
            { list: 5, shoresh: "נ.ס.ע", english: "Travel" },
            { list: 5, shoresh: "מ.כ.ר", english: "Sell" },
            { list: 5, shoresh: "נ.צ.ב", english: "Stand" },
            { list: 5, shoresh: "י.כ.ל", english: "Able, Can" },
            { list: 5, shoresh: "א.מ.נ", english: "Believe" },
            { list: 5, shoresh: "ר.ו.צ", english: "Run" },
            { list: 5, shoresh: "ע.ז.ב", english: "Leave" },
            { list: 5, shoresh: "ק.ר.ב", english: "Come close" },
            { list: 5, shoresh: "מ.ה.ר", english: "Hurry/Be Quick" },
            { list: 5, shoresh: "שׁ.ת.ה", english: "Drink" },
            { list: 6, shoresh: "כ.ל.ה", english: "Finish" },
            { list: 6, shoresh: "נ.ג.ד", english: "Tell" },
            { list: 6, shoresh: "ב.ר.ח", english: "Run away" },
            { list: 6, shoresh: "פ.ת.ח", english: "Open" },
            { list: 6, shoresh: "נ.פ.ל", english: "Fall" },
            { list: 6, shoresh: "ב.כ.ה", english: "Cry" },
            { list: 6, shoresh: "י.ר.א", english: "Fear" },
            { list: 6, shoresh: "ח.י.ה", english: "Live" },
            { list: 6, shoresh: "ב.ק.שׁ", english: "Ask for/Request" },
            { list: 6, shoresh: "ח.שׁ.ב", english: "Think" },
            { list: 7, shoresh: "צ.ח.ק", english: "Laugh" },
            { list: 7, shoresh: "ס.ג.ר", english: "Close" },
            { list: 7, shoresh: "צ.ע.ק", english: "Cry Out" },
            { list: 7, shoresh: "שׁ.כ.ב", english: "Lay down" },
            { list: 7, shoresh: "שׁ.ב.ע", english: "Swear, Promise" },
            { list: 7, shoresh: "שׁ.א.ל", english: "Ask" },
            { list: 7, shoresh: "נ.ו.ח", english: "Rest" },
            { list: 7, shoresh: "ח.ס.ר", english: "Decrease, Become less" },
            { list: 7, shoresh: "ק.נ.ה", english: "Buy" },
            { list: 7, shoresh: "ג.א.ל", english: "Redeem" },
            { list: 8, shoresh: "י.ר.שׁ", english: "Inherit, Possess" },
            { list: 8, shoresh: "מ.שׁ.ל", english: "Rule" },
            { list: 8, shoresh: "י.שׁ.נ", english: "Sleep" },
            { list: 8, shoresh: "ט.ב.ל", english: "Dip" },
            { list: 8, shoresh: "י.שׁ.ע", english: "Save" },
            { list: 8, shoresh: "ח.נ.ה", english: "Camp" },
            { list: 8, shoresh: "א.ב.ד", english: "Lose, Destroy" },
            { list: 8, shoresh: "ה.פ.כ", english: "Turn" },
            { list: 8, shoresh: "ד.ר.שׁ", english: "Seek out" },
            { list: 8, shoresh: "ח.ז.ק", english: "Be strong" },
            { list: 9, shoresh: "שׂ.ב.ע", english: "Satisfy" },
            { list: 9, shoresh: "שׁ.כ.ח", english: "Forget" },
            { list: 9, shoresh: "נ.כ.ה", english: "Hit/Strike" },
            { list: 9, shoresh: "נ.ו.ס", english: "Flee/Run away" },
            { list: 9, shoresh: "פ.ק.ד", english: "Appoint, Count, Remember" },
            { list: 9, shoresh: "ק.ר.ע", english: "Tear/Rip" },
            { list: 9, shoresh: "ק.ב.ר", english: "Bury" },
            { list: 9, shoresh: "ס.פ.ר", english: "Tell, Count" },
            { list: 9, shoresh: "נ.ט.ה", english: "Stretch out" },
            { list: 9, shoresh: "י.ס.פ", english: "Add" },
            { list: 10, shoresh: "שׁ.ל.כ", english: "Throw" },
            { list: 10, shoresh: "ג.ו.ר", english: "Live" },
            { list: 10, shoresh: "שׁ.ב.ר", english: "Break" },
            { list: 10, shoresh: "ס.ב.ב", english: "Surround" },
            { list: 10, shoresh: "י.צ.ר", english: "Form" },
            { list: 10, shoresh: "שׁ.ח.ת", english: "Destroy" },
            { list: 10, shoresh: "נ.ג.ע", english: "Touch" },
            { list: 10, shoresh: "ר.ב.ה", english: "Multiply, Be many" },
            { list: 10, shoresh: "ע.ז.ר", english: "Help" },
            { list: 10, shoresh: "כ.ס.ה", english: "Cover" },
            { list: 11, shoresh: "ח.ט.א", english: "Sin" },
            { list: 11, shoresh: "פ.ל.ל", english: "Pray" },
            { list: 11, shoresh: "כ.ו.נ", english: "Prepare" },
            { list: 11, shoresh: "כ.ר.ת", english: "Cut, Make a treaty" },
            { list: 11, shoresh: "ס.ו.ר", english: "Turn aside, Remove" },
            { list: 11, shoresh: "מ.ל.כ", english: "Be king/Reign" },
            { list: 11, shoresh: "ר.ו.מ", english: "Be high" },
            { list: 11, shoresh: "ר.צ.ה", english: "Want, Be Pleased" },
            { list: 11, shoresh: "שׁ.פ.ט", english: "Judge" },
            { list: 11, shoresh: "נ.צ.ל", english: "Save, Snatch" },
            { list: 12, shoresh: "ב.ו.שׁ", english: "Be ashamed/Be embarrassed" },
            { list: 12, shoresh: "ה.ל.ל", english: "Praise" },
            { list: 12, shoresh: "ז.ב.ח", english: "Sacrifice" },
            { list: 12, shoresh: "ב.ט.ח", english: "Trust" },
            { list: 12, shoresh: "י.ת.ר", english: "Remain" },
            { list: 12, shoresh: "ג.ל.ה", english: "Reveal" },
            { list: 12, shoresh: "ל.כ.ד", english: "Capture" },
            { list: 12, shoresh: "שׁ.כ.נ", english: "Dwell" },
            { list: 12, shoresh: "שׂ.נ.א", english: "Hate" },
            { list: 12, shoresh: "ב.י.נ", english: "Understand" },
            { list: 13, shoresh: "כ.פ.ר", english: "Atone/Ask for forgiveness" },
            { list: 13, shoresh: "נ.ג.שׁ", english: "Approach" },
            { list: 13, shoresh: "ל.ח.מ", english: "Fight/Battle" },
            { list: 13, shoresh: "פ.נ.ה", english: "Turn" },
            { list: 13, shoresh: "ג.ר.שׁ", english: "Drive out/Chase away" },
            { list: 13, shoresh: "שׁ.א.ר", english: "Remain" },
            { list: 13, shoresh: "ב.ח.ר", english: "Choose" },
            { list: 13, shoresh: "כ.ב.ד", english: "Be heavy, Honor" },
            { list: 13, shoresh: "שׂ.ר.פ", english: "Burn" },
            { list: 13, shoresh: "ל.ב.שׁ", english: "Put on/Dress" },
            { list: 14, shoresh: "ק.ב.צ", english: "Gather together" },
            { list: 14, shoresh: "שׁ.פ.כ", english: "Pour" },
            { list: 14, shoresh: "מ.א.נ", english: "Refuse" },
            { list: 14, shoresh: "ר.ד.פ", english: "Chase" },
            { list: 14, shoresh: "א.ח.ז", english: "Grab" },
            { list: 14, shoresh: "ד.ר.כ", english: "Walk on" },
            { list: 14, shoresh: "ז.ע.ק", english: "Scream out" },
            { list: 14, shoresh: "שׁ.כ.מ", english: "Rise early" },
            { list: 14, shoresh: "ב.ע.ר", english: "Burn, Destroy" },
            { list: 14, shoresh: "כ.ע.ס", english: "Be angry" },
            { list: 15, shoresh: "ח.ל.ק", english: "Divide" },
            { list: 15, shoresh: "ח.ר.ה", english: "Be angry" },
            { list: 15, shoresh: "נ.ח.ל", english: "Inherit" },
            { list: 15, shoresh: "ע.ר.ב", english: "Mix" },
            { list: 15, shoresh: "פ.ר.שׁ", english: "Spread out" },
            { list: 15, shoresh: "שׁ.ק.ה", english: "Give to drink/Water" },
            { list: 15, shoresh: "שׁ.מ.ד", english: "Destroy" },
            { list: 15, shoresh: "ר.ח.מ", english: "Have mercy" },
            { list: 15, shoresh: "ל.ו.נ", english: "Lodge/Sleepover" },
            { list: 15, shoresh: "י.ע.צ", english: "Advise" },
            { list: 16, shoresh: "ק.ד.שׁ", english: "Be holy" },
            { list: 16, shoresh: "ח.נ.נ", english: "Be gracious" },
            { list: 16, shoresh: "ד.ב.ק", english: "Cling/Stick" },
            { list: 16, shoresh: "שׁ.י.ת", english: "Put/Place" },
            { list: 16, shoresh: "צ.ל.ח", english: "Succeed, Prosper" },
            { list: 16, shoresh: "י.ב.שׁ", english: "Be dry" },
            { list: 16, shoresh: "שׁ.ח.ט", english: "Kill, Slaughter" },
            { list: 16, shoresh: "ת.פ.שׁ", english: "Catch, Seize" },
            { list: 16, shoresh: "שׁ.י.ר", english: "Sing" },
            { list: 16, shoresh: "ר.כ.ב", english: "Ride" },
            { list: 17, shoresh: "א.ב.ל", english: "Mourn" },
            { list: 17, shoresh: "ח.מ.ל", english: "Pity" },
            { list: 17, shoresh: "מ.ו.ל", english: "Circumcise" },
            { list: 17, shoresh: "ג.נ.ב", english: "Steal" },
            { list: 17, shoresh: "פ.ח.ד", english: "Fear" },
            { list: 17, shoresh: "נ.שׁ.ק", english: "Kiss" },
            { list: 17, shoresh: "ח.ב.א", english: "Hide" },
            { list: 17, shoresh: "נ.ה.ג", english: "Lead, Drive" },
            { list: 17, shoresh: "י.ר.ה", english: "Instruct, Thank, Cast" },
            { list: 17, shoresh: "ח.ל.ל", english: "Pollute, Begin" },
            { list: 18, shoresh: "ט.מ.א", english: "Be Impure" },
            { list: 18, shoresh: "שׁ.ח.ה", english: "Bend down, Bow" },
            { list: 18, shoresh: "ר.ע.ה", english: "Shepherd, Graze" },
            { list: 18, shoresh: "נ.ב.א", english: "Prophesize" },
            { list: 18, shoresh: "שׂ.מ.ח", english: "Be Glad" },
            { list: 18, shoresh: "ח.פ.צ", english: "Desire" },
            { list: 18, shoresh: "ר.י.ב", english: "Argue" },
            { list: 18, shoresh: "שׁ.ל.מ", english: "Be whole" },
            { list: 18, shoresh: "ר.ח.צ", english: "Wash" },
            { list: 18, shoresh: "ח.ל.מ", english: "Dream" },
            { list: 19, shoresh: "שׁ.ב.ת", english: "Rest, Stop" },
            { list: 19, shoresh: "ה.ר.ס", english: "Break/Tear down" },
            { list: 19, shoresh: "ת.מ.מ", english: "Be complete" },
            { list: 19, shoresh: "שׁ.ר.ת", english: "Serve" },
            { list: 19, shoresh: "ב.ק.ע", english: "Split" },
            { list: 19, shoresh: "ט.ה.ר", english: "Be pure" },
            { list: 19, shoresh: "ח.ל.ה", english: "Be sick" },
            { list: 19, shoresh: "ה.ר.ה", english: "Become pregnant/Conceive" },
            { list: 19, shoresh: "פ.ל.א", english: "Separate, Be wonderful" },
            { list: 19, shoresh: "כ.ר.ע", english: "Bend at the knee" },
            { list: 20, shoresh: "פ.ע.ל", english: "Do, make" },
            { list: 20, shoresh: "ר.ח.ק", english: "Be far" },
            { list: 20, shoresh: "מ.שׁ.כ", english: "Drag, Pull, Draw out" },
            { list: 20, shoresh: "ב.ל.ע", english: "Swallow" },
            { list: 20, shoresh: "ק.ה.ל", english: "Congregate/Assemble" },
            { list: 20, shoresh: "ח.ד.ל", english: "Stop/Cease" },
            { list: 20, shoresh: "ס.ל.ח", english: "Forgive" },
            { list: 20, shoresh: "פ.ר.ד", english: "Separate" },
            { list: 20, shoresh: "נ.ס.ה", english: "Try, Tempt" },
            { list: 20, shoresh: "ק.נ.א", english: "Be jealous" },
            { list: 21, shoresh: "פ.ד.ה", english: "Redeem" },
            { list: 21, shoresh: "ב.א.שׁ", english: "Stink" },
            { list: 21, shoresh: "י.נ.ק", english: "Nurse, Suck" },
            { list: 21, shoresh: "מ.שׁ.ח", english: "Anoint" },
            { list: 21, shoresh: "ס.ג.ר", english: "Shut" },
            { list: 21, shoresh: "א.פ.ה", english: "Bake" },
            { list: 21, shoresh: "שׁ.מ.מ", english: "Be astonished, Desolate/Uninhabited" },
            { list: 21, shoresh: "ס.ת.ר", english: "Conceal/Hide" },
            { list: 21, shoresh: "ע.ו.ר", english: "Awake" },
            { list: 21, shoresh: "ק.ט.ר", english: "Burn incense" },
            { list: 22, shoresh: "ע.ר.כ", english: "Arrange" },
            { list: 22, shoresh: "פ.ו.צ", english: "Scatter" },
            { list: 22, shoresh: "א.ר.ר", english: "Curse" },
            { list: 22, shoresh: "כ.ב.ס", english: "Wash" },
            { list: 22, shoresh: "מ.ד.ד", english: "Measure" },
            { list: 22, shoresh: "ח.ר.מ", english: "Devote, Destroy" },
            { list: 22, shoresh: "כ.שׁ.ל", english: "Stumble, Fail" },
            { list: 22, shoresh: "ת.ק.ע", english: "Blow" },
            { list: 22, shoresh: "א.ס.ר", english: "Forbid, Bind" },
            { list: 22, shoresh: "ב.שׁ.ל", english: "Boil" },
            { list: 23, shoresh: "ר.נ.נ", english: "Sing, Be joyful" },
            { list: 23, shoresh: "ג.ז.ל", english: "Steal" },
            { list: 23, shoresh: "ז.ר.ק", english: "Sprinkle, Throw" },
            { list: 23, shoresh: "א.שׁ.מ", english: "Be guilty" },
            { list: 23, shoresh: "ט.ב.ל", english: "Dip" },
            { list: 23, shoresh: "נ.צ.ח", english: "Win" },
            { list: 23, shoresh: "א.ב.ה", english: "Be willing" },
            { list: 23, shoresh: "צ.מ.א", english: "Be thirsty" },
            { list: 23, shoresh: "מ.ל.ט", english: "Escape" },
            { list: 23, shoresh: "צ.פ.ה", english: "Watch, Cover" },
            { list: 24, shoresh: "ז.ר.ע", english: "Sow/Spread seeds" },
            { list: 24, shoresh: "י.כ.ח", english: "Rebuke" },
            { list: 24, shoresh: "ק.ל.ל", english: "Curse, Be light" },
            { list: 24, shoresh: "ל.ק.ט", english: "Gather" },
            { list: 24, shoresh: "ח.ק.ר", english: "Search" },
            { list: 24, shoresh: "שׁ.א.ב", english: "Draw water" },
            { list: 24, shoresh: "ח.ת.מ", english: "Seal" },
            { list: 24, shoresh: "פ.ר.ה", english: "Be fruitful" },
            { list: 24, shoresh: "ר.צ.ח", english: "Murder" },
            { list: 24, shoresh: "ק.ר.ה", english: "Happen, Meet" },
            { list: 25, shoresh: "צ.פ.נ", english: "Conceal" },
            { list: 25, shoresh: "נ.ק.ה", english: "Clean, Be innocent" },
            { list: 25, shoresh: "פ.ג.ע", english: "Meet, Smite/Hit" },
            { list: 25, shoresh: "ת.ל.ה", english: "Hang" },
            { list: 25, shoresh: "צ.ד.ק", english: "Be righteous" },
            { list: 25, shoresh: "מ.ח.ה", english: "Wipe off, Destroy" },
            { list: 25, shoresh: "נ.ד.ר", english: "Vow/Promise" },
            { list: 25, shoresh: "צ.מ.ח", english: "Sprout" },
            { list: 25, shoresh: "י.ס.ד", english: "Found/Establish" },
            { list: 25, shoresh: "י.צ.ק", english: "Pour out" },
            { list: 26, shoresh: "פ.ר.ח", english: "Sprout, Flourish" },
            { list: 26, shoresh: "נ.ס.כ", english: "Pour out, Anoint" },
            { list: 26, shoresh: "שׁ.פ.ל", english: "Be low" },
            { list: 26, shoresh: "ר.שׁ.ע", english: "Be wicked" },
            { list: 26, shoresh: "פ.ר.צ", english: "Spread, Break up" },
            { list: 26, shoresh: "נ.ו.פ", english: "Shake, Wave, Sift" },
            { list: 26, shoresh: "מ.ר.ה", english: "Rebel" },
            { list: 26, shoresh: "נ.ק.מ", english: "Avenge" },
            { list: 26, shoresh: "א.נ.ח", english: "Sigh" },
            { list: 26, shoresh: "ר.ג.ל", english: "Spy, Gossip" },
            { list: 27, shoresh: "ק.שׁ.ר", english: "Bind, Conspire" },
            { list: 27, shoresh: "ח.פ.שׂ", english: "Search" },
            { list: 27, shoresh: "ח.ר.שׁ", english: "Plow" },
            { list: 27, shoresh: "שׁ.ק.ט", english: "Be quiet" },
            { list: 27, shoresh: "ק.שׁ.ה", english: "Be hard" },
            { list: 27, shoresh: "ח.ג.ר", english: "Gird/Put on belt" },
            { list: 27, shoresh: "פ.שׁ.ט", english: "Strip off" },
            { list: 27, shoresh: "נ.ג.פ", english: "Smite/Strike" },
            { list: 27, shoresh: "ק.שׁ.ב", english: "Be attentive, Listen" },
            { list: 27, shoresh: "ע.ו.פ", english: "Fly" },
            { list: 28, shoresh: "מ.נ.ה", english: "Divide, Allot to" },
            { list: 28, shoresh: "ק.ו.ה", english: "Wait, Expect" },
            { list: 28, shoresh: "נ.ו.ע", english: "Move, Nod" },
            { list: 28, shoresh: "ח.ר.ד", english: "Tremble" },
            { list: 28, shoresh: "ק.ד.מ", english: "Be Before/Proceed" },
            { list: 28, shoresh: "ב.ג.ד", english: "Be a traitor" },
            { list: 28, shoresh: "ח.ב.שׁ", english: "Bind, Put on hat or belt" },
            { list: 28, shoresh: "ע.ו.ד", english: "Testify" },
            { list: 28, shoresh: "ח.ב.ר", english: "Join, Associate" },
            { list: 28, shoresh: "ר.ח.ב", english: "Be wide" },
            { list: 29, shoresh: "מ.א.ס", english: "Reject" },
            { list: 29, shoresh: "ח.ז.ה", english: "See/Gaze at" },
            { list: 29, shoresh: "שׂ.כ.ל", english: "Act wisely, Prosper" },
            { list: 29, shoresh: "ד.י.נ", english: "Judge" },
            { list: 29, shoresh: "שׁ.ב.ח", english: "Praise" },
            { list: 29, shoresh: "ח.ג.ג", english: "Celebrate" },
            { list: 29, shoresh: "מ.ר.ר", english: "Be bitter" },
            { list: 29, shoresh: "ק.צ.ר", english: "Be short" },
            { list: 29, shoresh: "ח.שׁ.כ", english: "Be dark" },
            { list: 29, shoresh: "ח.כ.ה", english: "Wait" },
            { list: 30, shoresh: "ג.ז.ר", english: "Cut off" },
            { list: 30, shoresh: "ח.פ.ר", english: "Dig" },
            { list: 30, shoresh: "ר.ו.ע", english: "Shout" },
            { list: 30, shoresh: "מ.ר.ד", english: "Rebel" },
            { list: 30, shoresh: "כ.נ.ס", english: "Gather" },
            { list: 30, shoresh: "ט.ב.ע", english: "Sink" },
            { list: 30, shoresh: "צ.ו.ד", english: "Hunt" },
            { list: 30, shoresh: "פ.ג.שׁ", english: "Meet" },
            { list: 30, shoresh: "פ.ק.ח", english: "Open" },
            { list: 30, shoresh: "י.א.ל", english: "Desire, Be willing" }
        ];

        // --- UTILS ---
        const shuffleArray = (array) => {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        };

        const normalize = (str) => str.toLowerCase().replace(/\s+/g, ' ').trim();
        const getParts = (str) => str.split(/[\/,]+/).map(p => normalize(p)).filter(p => p.length > 0);

        const checkAnswer = (userInput, correct) => {
            const normUser = normalize(userInput);
            const normCorrect = normalize(correct);
            
            // AND Logic (Comma in correct answer) -> Must provide ALL parts
            if (normCorrect.includes(',')) {
                const requiredParts = getParts(normCorrect);
                const userParts = getParts(normUser);
                return requiredParts.every(req => userParts.includes(req));
            }

            // OR Logic (Slash in correct answer) -> All provided parts must be valid options
            if (normCorrect.includes('/')) {
                const acceptedOptions = getParts(normCorrect);
                const userParts = getParts(normUser);
                
                if (userParts.length === 0) return false;

                return userParts.every(part => acceptedOptions.includes(part));
            }

            // Simple match
            return normUser === normCorrect;
        };

        // --- APP COMPONENT ---
        const App = () => {
            const [gameState, setGameState] = useState('menu');
            const [selectedWeeks, setSelectedWeeks] = useState([]);
            const [questions, setQuestions] = useState([]);
            const [currentIndex, setCurrentIndex] = useState(0);
            const [userAnswer, setUserAnswer] = useState('');
            const [score, setScore] = useState(0);
            const [feedback, setFeedback] = useState(null);
            const [incorrectAttempts, setIncorrectAttempts] = useState([]);

            const availableWeeks = Array.from(new Set(DATA_SOURCE.map(d => d.list))).sort((a, b) => a - b);

            const toggleWeek = (week) => {
                setSelectedWeeks(prev => 
                    prev.includes(week) ? prev.filter(w => w !== week) : [...prev, week]
                );
            };

            const selectAll = () => {
                if (selectedWeeks.length === availableWeeks.length) {
                    setSelectedWeeks([]);
                } else {
                    setSelectedWeeks(availableWeeks);
                }
            };

            const startGame = () => {
                if (selectedWeeks.length === 0) return;
                const filtered = DATA_SOURCE.filter(d => selectedWeeks.includes(d.list));
                setQuestions(shuffleArray(filtered));
                setScore(0);
                setIncorrectAttempts([]);
                setCurrentIndex(0);
                setGameState('playing');
                setFeedback(null);
                setUserAnswer('');
            };

            const handleSubmit = (e) => {
                e.preventDefault();
                if (feedback) return;

                const currentQ = questions[currentIndex];
                const isCorrect = checkAnswer(userAnswer, currentQ.english);

                if (isCorrect) {
                    setScore(s => s + 1);
                    setFeedback({
                        isCorrect: true,
                        message: 'Correct!',
                        correctAnswer: currentQ.english
                    });
                } else {
                    setIncorrectAttempts(prev => [...prev, {
                        list: currentQ.list,
                        shoresh: currentQ.shoresh,
                        correct: currentQ.english,
                        user: userAnswer
                    }]);

                    setFeedback({
                        isCorrect: false,
                        message: 'Incorrect.',
                        correctAnswer: currentQ.english
                    });
                }
            };

            const nextQuestion = () => {
                setFeedback(null);
                setUserAnswer('');
                if (currentIndex < questions.length - 1) {
                    setCurrentIndex(prev => prev + 1);
                } else {
                    setGameState('finished');
                }
            };

            useEffect(() => {
                const handleKeyDown = (e) => {
                    if (e.key === 'Enter' && feedback) {
                        e.preventDefault(); 
                        nextQuestion();
                    }
                };
                window.addEventListener('keydown', handleKeyDown);
                return () => window.removeEventListener('keydown', handleKeyDown);
            }, [feedback, currentIndex, questions.length]);

            // --- VIEWS ---

            if (gameState === 'menu') {
                return (
                    <div className="max-w-2xl mx-auto bg-white p-8 rounded-xl shadow-lg mt-10 m-4">
                        <div className="text-center mb-8">
                            <BookOpen className="w-12 h-12 mx-auto text-blue-600 mb-4" />
                            <h1 className="text-3xl font-bold text-gray-800">Tanakh Shorashim Quiz</h1>
                            <div className="text-gray-500 mt-2 font-medium">5th Grade • Berman Hebrew Academy</div>
                            <p className="text-gray-400 text-sm mt-1">Select the lists you want to study</p>
                        </div>

                        <div className="flex justify-center mb-4">
                            <button onClick={selectAll} className="text-sm text-blue-600 hover:text-blue-800 font-medium">
                                {selectedWeeks.length === availableWeeks.length ? 'Deselect All' : 'Select All'}
                            </button>
                        </div>

                        <div className="grid grid-cols-4 sm:grid-cols-5 gap-3 mb-8">
                            {availableWeeks.map(week => (
                                <button
                                    key={week}
                                    onClick={() => toggleWeek(week)}
                                    className={`p-2 sm:p-3 rounded-lg border-2 text-sm sm:text-base transition-all ${
                                        selectedWeeks.includes(week)
                                            ? 'border-blue-500 bg-blue-50 text-blue-700 font-semibold shadow-sm'
                                            : 'border-gray-200 hover:border-blue-300 text-gray-600'
                                    }`}
                                >
                                    List {week}
                                </button>
                            ))}
                        </div>

                        <button
                            onClick={startGame}
                            disabled={selectedWeeks.length === 0}
                            className={`w-full py-4 rounded-xl text-lg font-bold flex items-center justify-center gap-2 text-white transition-all ${
                                selectedWeeks.length > 0
                                    ? 'bg-blue-600 hover:bg-blue-700 shadow-md transform hover:-translate-y-0.5'
                                    : 'bg-gray-300 cursor-not-allowed'
                            }`}
                        >
                            <Play className="w-5 h-5 fill-current" />
                            Start Quiz
                        </button>
                    </div>
                );
            }

            if (gameState === 'playing') {
                const currentQ = questions[currentIndex];
                return (
                    <div className="max-w-lg mx-auto mt-6 px-4">
                        <div className="mb-8">
                            <div className="flex justify-between text-sm font-medium text-gray-500 mb-2">
                                <span>Question {currentIndex + 1} of {questions.length}</span>
                                <span>Score: {score}</span>
                            </div>
                            <div className="h-2 bg-gray-200 rounded-full overflow-hidden">
                                <div className="h-full bg-blue-500 transition-all duration-300" style={{ width: `${((currentIndex) / questions.length) * 100}%` }} />
                            </div>
                        </div>

                        <div className="bg-white rounded-2xl shadow-xl overflow-hidden min-h-[400px] flex flex-col relative">
                            <div className="absolute top-4 right-4 bg-gray-100 px-3 py-1 rounded-full text-xs font-bold text-gray-500">
                                List {currentQ.list}
                            </div>

                            <div className="flex-grow flex flex-col items-center justify-center p-8 text-center bg-gray-50">
                                <div className="text-gray-400 text-sm font-uppercase tracking-wider mb-2">Hebrew Shoresh</div>
                                <h2 className="text-6xl font-bold text-gray-800 font-serif mb-6" dir="rtl">{currentQ.shoresh}</h2>
                            </div>

                            <div className="p-8 bg-white">
                                {!feedback ? (
                                    <form onSubmit={handleSubmit}>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">English Translation</label>
                                        <input
                                            type="text"
                                            autoFocus
                                            value={userAnswer}
                                            onChange={(e) => setUserAnswer(e.target.value)}
                                            className="w-full p-4 text-lg border-2 border-gray-200 rounded-xl focus:border-blue-500 focus:ring-4 focus:ring-blue-500/10 outline-none transition-all"
                                            placeholder="Type answer here..."
                                        />
                                        <button type="submit" className="w-full mt-4 bg-gray-900 text-white font-bold py-3 rounded-xl hover:bg-gray-800 transition-colors">Submit</button>
                                        <div className="text-xs text-gray-400 mt-3 text-center">Tip: Use commas if multiple meanings are required.</div>
                                    </form>
                                ) : (
                                    <div className="animate-in fade-in slide-in-from-bottom-4 duration-300">
                                        <div className={`p-4 rounded-xl mb-4 flex items-start gap-3 ${feedback.isCorrect ? 'bg-green-50 text-green-800' : 'bg-red-50 text-red-800'}`}>
                                            {feedback.isCorrect ? <Check className="w-6 h-6 flex-shrink-0 mt-0.5 text-green-600" /> : <X className="w-6 h-6 flex-shrink-0 mt-0.5 text-red-600" />}
                                            <div>
                                                <div className="font-bold text-lg">{feedback.isCorrect ? 'Correct!' : 'Incorrect'}</div>
                                                {!feedback.isCorrect && (
                                                    <div className="mt-1">
                                                        <span className="opacity-75">Correct answer: </span>
                                                        <span className="font-semibold">{feedback.correctAnswer}</span>
                                                    </div>
                                                )}
                                            </div>
                                        </div>
                                        <button onClick={nextQuestion} ref={(btn) => btn?.focus()} className={`w-full py-3 rounded-xl font-bold flex items-center justify-center gap-2 text-white transition-all ${feedback.isCorrect ? 'bg-green-600 hover:bg-green-700' : 'bg-blue-600 hover:bg-blue-700'}`}>
                                            Next Question <ChevronRight className="w-4 h-4" />
                                        </button>
                                        <div className="text-xs text-gray-400 mt-2 text-center">Press Enter to continue</div>
                                    </div>
                                )}
                            </div>
                        </div>
                    </div>
                );
            }

            if (gameState === 'finished') {
                const percentage = Math.round((score / questions.length) * 100);
                return (
                    <div className="max-w-xl mx-auto mt-10 px-4 pb-20">
                        <div className="bg-white p-8 rounded-xl shadow-lg text-center animate-in zoom-in duration-300">
                            <Award className={`w-20 h-20 mx-auto mb-6 ${percentage >= 80 ? 'text-yellow-500' : 'text-blue-500'}`} />
                            <h2 className="text-3xl font-bold text-gray-800 mb-2">Quiz Complete!</h2>
                            <p className="text-gray-500 mb-8">Here is how you did</p>
                            <div className="bg-gray-50 rounded-2xl p-6 mb-8">
                                <div className="text-5xl font-black text-gray-900 mb-2">{percentage}%</div>
                                <div className="text-gray-500 font-medium">{score} out of {questions.length} correct</div>
                            </div>
                            <button onClick={() => setGameState('menu')} className="w-full py-4 bg-gray-900 text-white rounded-xl font-bold flex items-center justify-center gap-2 hover:bg-gray-800 transition-all">
                                <RotateCcw className="w-5 h-5" />
                                Play Again
                            </button>
                        </div>

                        {incorrectAttempts.length > 0 && (
                            <div className="mt-8 animate-in slide-in-from-bottom-8 duration-500">
                                <h3 className="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                                    <AlertCircle className="text-red-500 w-5 h-5" />
                                    Review Incorrect Answers
                                </h3>
                                <div className="space-y-4">
                                    {incorrectAttempts.map((attempt, idx) => (
                                        <div key={idx} className="bg-white p-5 rounded-xl shadow-sm border-l-4 border-red-500 flex flex-col sm:flex-row gap-4 justify-between items-center sm:items-start text-center sm:text-left">
                                            <div className="flex flex-col items-center sm:items-start min-w-[100px]">
                                                <span className="text-xs font-bold text-gray-400 uppercase tracking-wide mb-1">List {attempt.list}</span>
                                                <span className="text-3xl font-serif font-bold text-gray-800 mb-2 sm:mb-0" dir="rtl">{attempt.shoresh}</span>
                                            </div>
                                            <div className="flex-grow flex flex-col gap-2 w-full sm:w-auto">
                                                <div className="bg-red-50 p-3 rounded-lg w-full">
                                                    <div className="text-xs text-red-600 font-semibold mb-1">Your Answer</div>
                                                    <div className="text-red-800 line-through decoration-red-400">{attempt.user || "(Empty)"}</div>
                                                </div>
                                                <div className="bg-green-50 p-3 rounded-lg w-full">
                                                    <div className="text-xs text-green-600 font-semibold mb-1">Correct Answer</div>
                                                    <div className="text-green-800 font-medium">{attempt.correct}</div>
                                                </div>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}
                    </div>
                );
            }
            return null;
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>


